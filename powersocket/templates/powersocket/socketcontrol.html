<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="refresh" content="10" >
  <title>Energenie-Pi</title>
  <meta name="generator" content="Google Web Designer 1.5.4.0113">
  <style type="text/css" id="gwd-text-style">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
  </style>
  <style type="text/css">
    html, body {
      width: 100%;
      height: 100%;
      margin: 0px;
      font-family: 'Lucida Console', Monaco, monospace;
    }
    td a {
      display: block;
      width: 100%;
      height: 100%;
    }
    body {
      transform: perspective(1400px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      transform-style: preserve-3d;
      background-color: rgb(105, 105, 105);
    }
    table, th, td {
      border: 5px solid rgb(105, 105, 105);
    }
    input[type="submit"] {
      color: black;
      font-size: 2em;
      font-family: 'Lucida Console', Monaco, monospace;
      width: 100%;
      height: 80px;
      border: none;
      text-align: center;
      margin: 0px;
      padding: 0px;
      font-weight: bold;
      background: transparent;
    }
    p {
      position: relative;
      top: -20px;
      text-align: center;
      width: 100%;
    }
    #allsubmit {
      color: black;
      font-size: 2em;
      font-family: 'Lucida Console', Monaco, monospace;
      width: 100%;
      height: 80px;
      border: none;
      text-align: center;
      margin: 0px;
      padding: 0px;
      font-weight: bold;
      background: transparent;
    }
    .schedule_group_div {
      color: white;
      text-align: center;
    }
    .schedule_div {
      padding: 10px; 
    }
  </style>
</head>

<body style="">
{% if sockets %}
  <table width="100%">
    <tbody>
      <tr height="50px">
        <td width="auto" bgcolor="DimGray">
          <h1>
        Energenie-Pi Control
        </h1>
        </td>
        <td width="200" bgcolor="GreenYellow" class="allsubmit">
          <form action="{% url 'powersocket:update_socket' 'allon' %}" method="post">
            {% csrf_token %}
            <input type="submit" value="All On">
          </form>
        </td>
        <td width="200" bgcolor="Brown" class="allsubmit">
          <form action="{% url 'powersocket:update_socket' 'alloff' %}" method="post">
            {% csrf_token %}
            <input type="submit" value="All Off">
          </form>
        </td>
      </tr>
      {% for socket in sockets %}
      <tr>
        {% if socket.current_state == True %}
        <td colspan="3" bgcolor="GreenYellow">
        {% else %}
        <td colspan="3" bgcolor="Brown">
        {% endif %}
          <form action="{% url 'powersocket:update_socket' socket.socket_id %}" method="post">
            {% csrf_token %}
            <input type="submit" value="{{ socket.name }}">
            {% if socket.current_state == True %}
            <input type="hidden" id="hiddenInput" name="change_to" value="off" />
            {% else %}
            <input type="hidden" id="hiddenInput" name="change_to" value="on" />
            {% endif %}
            <p>Schedules:
            {% if socket.schedule_set.all %}
            {% for sched in socket.schedule_set.all %}
            {{ sched }}
            {% endfor %}
            {% else %}
            (none)
            {% endif %}
            </p>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <div class="schedule_group_div">
    <h2>Schedule details</h2>
    {% for sched in schedules.all %}
    <div class="schedule_div">
      <p>
      <h3>{{ sched.description }}</h3>
      {% for timeslot in sched.time_slots.all %}
      {{ timeslot }}
      <br/>
      {% endfor %}
      </p>
    </div>
    {% endfor %}
  </div>
{% else %}
    <p>No sockets configured!</p>
{% endif %}
</body>

</html>
